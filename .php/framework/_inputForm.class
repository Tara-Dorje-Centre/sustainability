<?php 

class _inputSection extends _contentWriter{
protected $name;
protected $css;
protected $_div;
public function __construct(string $name,string $css){
$this->name = $name;
$this->css = $css;

$this->_div = new _div($this->name,$this->css);
$this->addContent($this->_div->open());
}
public function input(_field $f){
$this->addContent($f->input());
}
public function inputHidden(_field $f){
$this->addContent($f->inputHidden());
}
public function choice(_field $f,string $options){
$this->addContent($f->inputChoice($options));
}
public function print(){
$this->addContent($this->_div->close());
return $this->getContent();
}
}

class _inputForm extends _contentWriter{
	protected $_form;
	protected $_fields;
	protected $_display;
	protected $_fieldset;
	protected $_context;
	protected $div;
	protected $entity;
	protected $mode;
	protected $url;
	protected $title;
	protected $contextMenu;
	public $required;
	public $optional;
	public $hidden;
	public $submit;

	public function __construct(string $url,string $title){
		$this->url = $url;
		$this->title = $title;
		$this->required = new _inputSection('form-required','show');
		$this->optional = new _inputSection('form-optional','hide');
		$this->hidden = new _inputSection('form-hidden','show');
		$this->submit = new _inputSection('form-submit','show');
	}

	public function set(string $entity, string $mode, string $contextMenu = ''){
		$this->entity = $entity;
		$this->mode = $mode;
		$this->contextMenu = $contextMenu;
		$this->_form = new _form($this->url, $this->entity.'-edit-form','edit-form');
		$this->_fields = new _div($this->entity.'-fields','edit-fields');
	}
	public function open(string $entity, string $mode, string $contextMenu = ''){
		$this->set($entity, $mode, $contextMenu);

		$this->_display = new _div($this->entity.'-display-'.$this->mode,'display'.$this->mode);
		$this->addContent($this->_display->open());
		
		if (!is_null($this->contextMenu)){
			$this->_context = new _div($this->entity.'-context-menu','context-menu');
			$this->addContent($this->_context->wrap($this->contextMenu));
		}
		
		$legend = $this->mode.':  '.$this->title;
		$this->_fieldset = new _htmlFieldset($legend);
		$this->addContent($this->_fieldset->open());
		
		$this->addContent($this->_form->open());
		$this->addContent($this->_fields->open());

	}
	public function close(){ 

		$this->addContent($this->required->print());
		$this->addContent($this->optional->print());
		$this->addContent($this->submit->print());
		$this->addContent($this->hidden->print());
		
	
		$this->addContent($this->_fields->close());
		$this->addContent($this->_form->close());
		
		$this->addContent($this->_fieldset->close());
		$this->addContent($this->_display->close());
		
		return $this->getContent();
	}
	

	





}


 
?>
