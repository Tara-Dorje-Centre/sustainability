<?php 
namespace application\parameters;

class linkMenu extends \framework\_contentWriter{
	protected $_menu;
	protected $_list;
	protected $_links = array();
	protected $cssBase;
	protected $cssItem;
	protected $cssList;
	protected $type = 'DIV';
	protected $name = 'menu';  
	protected $nameList = 'menu-list';

	public function __construct(string $name = 'menu-listing', string $type = 'DIV', string $css = 'menu'){
		$this->initialize($name,$type,$css);
	}
	protected function initialize(string $name, string $type, string $css){
		$this->setName($name);
		$this->setCss($css);
		$this->setType($type);
		
		$this->_menu = new \html\_div($this->name,$this->css);
		if ($this->type == 'LIST'){
			$this->_list = new \html\_ul($this->nameList, $this->cssList);
		}
	}

	protected function setCss(string $css){
		$this->css = $css;
		$this->cssItem = $css.'-links-item';
		$this->cssList = $css.'-links-list';
	}

	protected function setType(string $type){
		$this->type = $type;
	}
	
	protected function setName(string $name){
		$this->name = $name;
		$this->nameList = $name.'-list';
	}
	
	public function makeLink(url &$u,string $caption){
		//$l = new link($u->print, $caption,$this->cssItem);
		$this->addLink($u->link($caption));
	}
	
	public function addLink(link $l){
		$this->_links[] = $l;
	}
	
	public function addSpan(\html\_span $s){
		$this->_links[] = $s;
	}
	
	public function makeTextItem(string $text){
		$s = new \html\_span($text,$this->cssItem);
		$this->addSpan($s);
	}
	
	protected function printLinks(){
		foreach ($this->_links as $l){
			$item = $this->formatItem($l->print());
			$this->_menu->addContent($item);
		}
	
	}
	
	protected function formatItem($content){
		if ($this->type == 'LIST'){
			$i = new \html\_li($content,$this->cssItem.'-li');
		} else {
			$i = new \html\_anyDiv($content,$this->cssItem);
		}
		return $i->print();		
	}
	
	protected function open(){
		if ($this->type == 'LIST'){
			$this->_menu->addContent($this->_list->open());
		}
		
	}

	protected function close(){
		if ($this->type == 'LIST'){
			$this->_menu->addContent($this->_list->close());
		} 
	}
	
	public function print(){
		$this->open();
		$this->printLinks();
		$this->close();
		return $this->_menu->print();
	}
		
}

?>
